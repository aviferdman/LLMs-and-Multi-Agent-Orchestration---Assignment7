{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "game_over.schema.json",
  "title": "GAME_OVER",
  "description": "Referee â†’ Both Players: Game finished, winner determined",
  "allOf": [
    { "$ref": "_base_message.schema.json" }
  ],
  "type": "object",
  "properties": {
    "message_type": {
      "const": "GAME_OVER"
    },
    "sender": {
      "type": "string",
      "pattern": "^referee:.+$"
    },
    "match_id": {
      "type": "string"
    },
    "game_type": {
      "type": "string",
      "enum": ["even_odd"]
    },
    "game_result": {
      "type": "object",
      "properties": {
        "status": {
          "type": "string",
          "enum": ["WIN", "DRAW", "TECHNICAL_LOSS"],
          "description": "Game outcome status"
        },
        "winner_player_id": {
          "type": ["string", "null"],
          "description": "Winning player ID, null if draw"
        },
        "drawn_number": {
          "type": "integer",
          "minimum": 0,
          "description": "Random number drawn"
        },
        "number_parity": {
          "type": "string",
          "enum": ["even", "odd"],
          "description": "Parity of the drawn number"
        },
        "choices": {
          "type": "object",
          "additionalProperties": {
            "type": "string",
            "enum": ["even", "odd"]
          },
          "description": "Map of player_id to their parity choice"
        },
        "reason": {
          "type": "string",
          "description": "Human-readable explanation of the result"
        }
      },
      "required": ["status", "winner_player_id", "drawn_number", "number_parity", "choices", "reason"],
      "description": "Game result details"
    }
  },
  "required": ["protocol", "message_type", "sender", "timestamp", "conversation_id", "match_id", "game_type", "game_result"]
}
